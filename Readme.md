# ä¹° jd é¢„çº¦æŠ¢è´­å•†å“ï¼ˆåŸjd_by_maskï¼‰

### æ­¤ä»£ç å—å¯å‘ https://github.com/tychxn/jd-assistan å®Œæˆ

## æ”¯æŒé¢„çº¦-æŠ¢è´­-æäº¤è®¢å•æµç¨‹çš„å•†å“

ç‹—ä¸œç°æœ‰ä¿©ç§æŠ¢è´­æ¨¡å¼, ç°åœ¨ç¨‹åºå†…éƒ¨å®ç°äº†è‡ªåŠ¨åŒºåˆ†ä¿©ç§æµç¨‹ã€‚åŒºåˆ†ä¾æ®å‚ç…§ä¸‹æ–‡`ä»£ç åˆ†æ`å¤„è´´çš„ä¿©ä¸ªjsæ–‡ä»¶
1. åˆ°æ—¶é—´ç›´æ¥æŠ¢è´­, ä¹Ÿå«ç§’æ€(ä¾‹å¦‚ä»¥å‰çš„å£ç½©, ç°åœ¨çš„èŒ…å°ç­‰)
2. åˆ°æ—¶é—´å…ˆæ·»åŠ è´­ç‰©è½¦ -> åˆ°è´­ç‰©è½¦æäº¤è®¢å•(æ™®é€šæ˜¾å¡é¢„çº¦æŠ¢è´­ç±»)  

å†™åœ¨å‰é¢
1. æ¨¡å¼1ç‰¹åˆ«è¯´æ˜: æ­¤æ¨¡å¼å•†å“å±•ç¤ºæ— æ˜æ˜¾ç‰¹å¾(consoleæ§åˆ¶å°å€’æ˜¯å¯ä»¥æ‰“å°å¯¹åº”å‚æ•°åŒºåˆ†).ä½†æ˜¯ä¼šå‘˜æœ‰èµ„æ ¼æŠ¢è´­çš„å•†å“, å¤§æ¦‚ç‡æ˜¯è¿™ç§æ¨¡å¼.**`æŠ¢è´­æ—¶é—´æœ‰å¯èƒ½ç«‹å³å¼€å§‹, ä¹Ÿæœ‰å¯èƒ½éœ€è¦é¢„çº¦ç»“æŸåå†ç­‰ä¸€å°æ®µæ—¶é—´(5minå·¦å³)æ‰å¯ä»¥æŠ¢è´­`**ã€‚éœ€è¦ä¸éœ€è¦å†ç­‰éƒ½é‡åˆ°è¿‡ã€‚æŠ¢è´­æ—¶æ³¨æ„ç»ˆç«¯ä¸­ä¼šæç¤º `"å½“å‰æµç¨‹æ˜¯é¢„çº¦ç§’æ€æµç¨‹`, è¿™æ ·çš„æç¤ºå°±æ˜¯æ­¤æ¨¡å¼. 
2. å¦‚æœéœ€è¦å†ç­‰1hå†…, ç¨‹åºä¼šé˜»å¡åœ¨æ­¤ç»§ç»­ç­‰å¾…æ‰§è¡Œ.è¶…è¿‡ä¸€ä¸ªå°æ—¶ä¼šé€€å‡º, æç¤ºä½ ä¿®æ”¹æ—¶é—´åå†é‡å¯
3. å› ä¸ºç‹—ä¸œæœ‰çº¢åŒ…çš„è¯, ä¼šè‡ªåŠ¨å‹¾é€‰ä½¿ç”¨çº¢åŒ….ä¸ºäº†æŠ¢è´­æˆåŠŸå’Œå¿«é€Ÿ,é…ç½®æ–‡ä»¶ä¸­æœ€å¥½å¡«å†™6ä½æ”¯ä»˜å¯†ç (ä¿å­˜å¯†ç çš„`config.js` **`ä¸ä¼šä»ä½ æœ¬åœ°ä¸Šä¼ åˆ°ä»»ä½•åœ°æ–¹,è¯·æ”¾å¿ƒ!!`**)
4. å·²çŸ¥ `windows` ç³»ç»Ÿè‡ªå¸¦ç»ˆç«¯æ‰“å°å‡ºæ¥çš„äºŒç»´ç é”™ä½, è¯·æ›´æ¢ç»ˆç«¯æˆ–è€…æ‰‹åŠ¨æ‰“å¼€è‡ªåŠ¨ç”Ÿæˆçš„æœ¬ç›®å½•ä¸‹`qrcode.png`æ–‡ä»¶æ‰«ç 
5. ç”±`jd_by_mask` æ”¹å `jd_yuyue`.ä¹‹å‰ä½¿ç”¨é”™åˆ«å­—é˜²æ­¢æœç´¢ä¸”ä¹°å£ç½©ä¹Ÿä¸ç¬¦åˆç°åœ¨ä»“åº“å†…å®¹, æ‰€ä»¥æ”¹åyuyueäº†

## Quick Start

1 **`å¿…é¡»é…ç½®configæ–‡ä»¶`**, åœ¨ç›®å½•ä¸‹æ–°åˆ›å»º `config.js` æ–‡ä»¶ã€‚æ ¼å¼å¦‚ä¸‹ï¼ˆå¯ä»¥ç›´æ¥å¤åˆ¶è¿‡å»å¡«å……å†…å®¹ï¼‰

```js
// æœ€ç®€å•åªåŠ  eid å’Œ fp
const config = {
  // æ”¯æŒè‡ªå®šä¹‰ UA
  userAgent:
    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36',
  // æ˜¯å¦å¾®ä¿¡å…¬ä¼—å·æ¨é€æŠ¢è´­ç»“æœ, éå¿…å¡«
  messenger: true, // true, false
  // key å€¼åœ¨ http://sc.ftqq.com/3.version, æŸ¥çœ‹ç”³è¯·ä½¿ç”¨çš„æ–¹æ³•. æŠŠkeyç²˜è´´è‡³è¿™é‡Œ, å¾®ä¿¡å…³æ³¨ç½‘ç«™ä¸­çš„å…¬ä¼—å·å³å¯.
  sckey: '', // string, messenger æ˜¯ true åˆ™ä¸ºå¿…å¡«, ä¸å¡«å†™ä¸å½±å“æŠ¢è´­æµç¨‹

  // å¿…å¡«,
  // æ–¹å¼1: jdç™»å½• pc ç«¯, éšä¾¿æäº¤ä¸€ä¸ªè®¢å•, åˆ©ç”¨è°·æ­Œæµè§ˆå™¨devtools, é€‰æ‹© `network`,
  // æŸ¥çœ‹ submitOrder (æ³¨æ„è¦å‹¾é€‰ preserve log, å¦åˆ™æäº¤è®¢å•è·³è½¬åçœ‹ä¸åˆ°è¯¥æ¥å£äº†) æ¥
  // å£, æŠŠæ¥å£æäº¤çš„æ•°æ®é‡Œé¢çš„ `eid`, å’Œ `fp` ä¿©ä¸ªå­—æ®µå€¼åˆ†åˆ«ç²˜è´´è¿‡æ¥
  // æ–¹å¼2: æˆ–è€…ç”µè„‘æ‰“å¼€ jd ç™»é™†é¡µé¢, devtools, é€‰æ‹© `Elements`, æœç´¢ eid å’Œ sessionId(å³fp), åœ¨æœç´¢åˆ°çš„inputå…ƒç´ ä¸Šé¢
  // value å±æ€§ä¸­çš„å€¼å¤åˆ¶è¿‡æ¥
  eid: '', // string, å¿…å¡«
  fp: '', // string, å¿…å¡«
  pwd: '', // 6ä½æ”¯ä»˜å¯†ç å¦‚ '123456' æœ€å¥½å¡«ä¸Š.å¦‚æœå½“å‰è´¦å·æœ‰çº¢åŒ…ä¹‹ç±»çš„åˆ™å¿…å¡«
};

module.exports = config;
```

2 éœ€è¦æœ‰ `node` å¼€å‘ç¯å¢ƒå¼€å‘ä½¿ç”¨ `nodejs` v12.xä»¥ä¸Š, æ²¡æœ‰ nodejs å®˜ç½‘ä¸‹è½½ä¸€ä¸ªå°±è¡Œ. ä¸‹è½½å®‰è£…å®Œåç»ˆç«¯æ‰§è¡Œ `node -v` æŸ¥çœ‹ç‰ˆæœ¬. å…¶è‡ªå¸¦åŒ…ç®¡ç†å™¨ `npm`

3 åœ¨ç›®å½•ä¸‹æ‰§è¡Œ `npm install` æˆ–è€… `yarn`(ä¸ç†Ÿæ‚‰çš„, å°±ç›´æ¥ä½¿ç”¨ npm æ•ˆæœä¸€æ ·çš„) å®‰è£…ä¾èµ–, å·²ç»é»˜è®¤é…ç½®ä½¿ç”¨ `taobao` é•œåƒåœ°å€ä¸‹è½½ä¾èµ–åŒ…

4 é…ç½®`tasks-pool.js`(ä»¥å‰åœ¨*index.js* ä¸­, ç°åœ¨è¿ç§»å‡ºæ¥äº†) ä¸­è®¾ç½®æ—¥æœŸ `date`, `areadId` å’Œè¦æŠ¢è´­çš„ `skuId`, æ ¼å¼å¦‚ä¸‹

```js
// æ—¥æœŸè¯´æ˜
// å¹´     æœˆ    æ—¥     æ—¶    åˆ†   ç§’     æ¯«ç§’
// 2020, 0-11, 1-31, 0-24, 0-60  0-60  0-1000
// ä¾‹å¦‚ 2020-3-4 10:00:00.400
// (2020, 2, 4, 10, 0, 0, 400)

// ä¿®æ”¹ä½¿ç”¨çš„æ—¶é—´
// 2020/3/3 10:00:00.400
const dd1 = new Date(2020, 2, 3, 10, 0, 0, 400).getTime();
// 2020/3/3 20:00:00.400
const dd2 = new Date(2020, 2, 3, 20, 0, 0, 400).getTime();
// 2020/3/3 21:00:00.400
const dd3 = new Date(2020, 2, 3, 21, 0, 0, 400).getTime();

// ä¿®æ”¹è¿™é‡Œ, æ·»åŠ skuId, æŠ¢è´­æ—¶é—´ date, areaId. éœ€è¦æ›´æ”¹ æœˆ/æ—¥ æ—¶:åˆ†:ç§’.æ¯«ç§’
// skuId è·å–æ–¹æ³•ï¼Œ æ‰“å¼€ä»»æ„ä¸€ä¸ªå•†å“è¯¦æƒ…é¡µå¦‚ `https://item.jd.com/100011521400.html`, åˆ™ `100011521400` å°±æ˜¯å…¶skuId
exports.pool = [
  // *ç°åœ¨å¿…é¡»è®¾ç½®areaId*
  // æ­¤ç¤ºä¾‹å¯¹åº”ä»æ·»åŠ è´­ç‰©è½¦æŠ¢è´­æµç¨‹
  // areaId è·å–åœ¨ç¬¬5æ­¥éª¤
  { skuId: '100011621642', date: dd2, areaId: `2_2825_51936` },
];
// è®¾ç½®è¦å¼ºåˆ¶ç™»å½•(æ²¡ææ‡‚ä½¿ç”¨åœºæ™¯çš„å¿½ç•¥æ­¤é…ç½®)
// è¯´æ˜: å› ä¸º x ä¸œ, 24å°æ—¶å°±è¦é‡æ–°ç™»å½•, é˜²æ­¢è¿è¡Œæ—¶ç™»å½•çŠ¶æ€æœ‰æ•ˆ
// å®šæ—¶æŠ¢è´­æ—¶ cookie è¿‡æœŸäº†, å°±å°´å°¬äº†.
// true å¼ºåˆ¶æ‰«ç ç™»å½•, ä¸ä½¿ç”¨å½“å‰å·²ç»å­˜åœ¨æœ¬åœ°çš„ cookie. ç™»å½•è¿‡åé¢‘ç¹é‡å¯æ—¶è®°å¾—å…³é—­
// å¦åˆ™ä¸€ç›´è¦æ‰«ç 
exports.forceLogin = false;
```
5 *å¿…é¡»*é…ç½®åœ°åŒº `areaId`. è¯·æ‰“å¼€é¡¹ç›®ç›®å½•ä¸‹ `area/ä½ æ‰€åœ¨çœä»½`, æ‰¾åˆ°ä½ æ‰€åœ¨åœ°åŒºå¯¹åº”çš„id å¤åˆ¶åˆ° `tasks-pool.js` ä¸­ã€‚ å¦‚ `area/2.ä¸Šæµ·.txt`, `'å´‡æ˜å¿/ä¸œå¹³é•‡:'2_2919_50783',` å¯¹åº” `'2_2919_50783'`, æŒ‰ç…§ä¸Šé¢ç¤ºèŒƒå¡«å…¥`tasks-pool.js`æ–‡ä»¶ä¸­  

6 å½“å‰ç›®å½•ä¸‹æ‰§è¡Œ `node index`  

7 æ‰«æç»ˆç«¯ä¸­çš„äºŒç»´ç ç™»å½•, 24 å°æ—¶ä¹‹å†…é‡å¯ä¸éœ€è¦å†æ¬¡æ‰«ç ç™»å½•, `cookie` ä¸²ä¼šä¿ç•™åœ¨æœ¬åœ°æ–‡ä»¶ä¸­ `cookie.json` ä¸­ã€‚è¿‡æœŸçš„è¯å¿…é¡»é‡æ–°æ‰«ç ï¼ˆä»£ç è‡ªåŠ¨æ ¡éªŒï¼‰

## Todo
- [ ] ç‹—ä¸œå¤ªæ¶å¿ƒäº†, åŒºåˆ†æµç¨‹çš„å…³é”®å‚æ•°, ç­‰åˆ°å¼€æŠ¢å‰å‡ åˆ†é’Ÿæ‰è·å–åˆ°, è¦æƒ³åŠæ³•å…¼å®¹ 
- [x] å¦‚æœé¢„çº¦æ—¶é—´ç»“æŸ, è¿˜éœ€è¦ç­‰å¾…ä¸€å°æ®µæ—¶é—´åæ‰æŠ¢è´­, ç¨‹åºè‡ªåŠ¨ç­‰å¾…æ‰§è¡Œ(1hå†…)
- [x] æ ¹æ®å•†å“, è‡ªåŠ¨ç¡®å®šæŠ¢è´­æµç¨‹
- [x] é’ˆå¯¹ä»è´­ç‰©è½¦æäº¤è®¢å•æµç¨‹ã€‚å¦‚æœæ­¤å•†å“å·²ç»åœ¨è´­ç‰©è½¦ä¸­, åˆ™ç›´æ¥æŠ¢è´­ä¸éœ€è¦æ‰§è¡Œæ·»åŠ è´­ç‰©è½¦æ“ä½œäº†

## ä»£ç åˆ†æ
åŒºåˆ†æŠ¢è´­æ¨¡å¼ä¸»è¦jsä»£ç æ–‡ä»¶
* [isKOé€»è¾‘js](https://static.360buyimg.com/item/unite/1.0.114/components/??default-soa/common/common.js,default-soa/address/address.js,default-soa/prom/prom.js,default-soa/colorsize/colorsize.js,default-soa/buytype/buytype.js,default-soa/baitiao/baitiao.js,default-soa/o2o/o2o.js,default-soa/buybtn/buybtn.js,default-soa/pingou/pingou.js,default-soa/track/track.js,default-soa/suits/suits.js,default-soa/crumb/crumb.js,default-soa/fittings/fittings.js,default-soa/contact/contact.js,default-soa/popbox/popbox.js,default-soa/preview/preview.js,default-soa/info/info.js,default-soa/imcenter/imcenter.js,default-soa/jdservice/jdservice.js,default-soa/jdservicePlus/jdservicePlus.js,default-soa/jdserviceF/jdserviceF.js,default-soa/commitments/commitments.js,default-soa/gift/gift.js,default-soa/vehicle/vehicle.js,default-soa/lazyinit/lazyinit.js,public-soa/modules/detail/detail.js)
* [è®¾ç½®æŒ‰é’®çŠ¶æ€é€»è¾‘](https://static.360buyimg.com/item/unite/1.0.114/components/??default/common/plugins/jQuery.scroller.js,default-soa/buybtn/reservation.js,default-soa/buybtn/ko.js,default-soa/buybtn/bigouma.js)

## Notice
- åå¯¹ jd è€çŒ´, æ›´åå¯¹æ»¥ç”¨ç›ˆåˆ©ä½œæ¶ï¼
- å¯¹ `windows` ç³»ç»Ÿä¸å‹å¥½, æœ‰é—®é¢˜åé¦ˆ
- è·ç¦»å¼€å§‹å‰åå‡ åˆ†é’Ÿå¯åŠ¨, æœ€å¥½ä¸è¦è®©è‡ªå·±ç”µè„‘åœ¨è¿™æœŸé—´é»‘å±å¾…æœº
- é¢„çº¦æ¯ä¸ªäººéƒ½å¾ˆå®¹æ˜“æ‹¿åˆ°, ä¸ç”¨ä½¿ç”¨è„šæœ¬æ‰§è¡Œé¢„çº¦
- è¿™æ˜¯ node ç‰ˆæœ¬, ä¸ç†Ÿæ‚‰çš„å¯ä½¿ç”¨ python ç‰ˆæœ¬.(æœ¬ç‰ˆæœ¬å€Ÿé‰´ä½¿ç”¨äº†ä¸‹é¢éƒ¨åˆ†åŠŸèƒ½å’Œèµ„æº)
- ~~https://github.com/zhou-xiaojun/jd_mask~~
- ~~https://github.com/tychxn/jd-assistant(è´­ç‰©è½¦é€»è¾‘å·²ç»æ›´æ”¹äº†, æ­¤è„šæœ¬åç»­æ²¡æœ‰æ›´æ–°, åº”è¯¥éƒ½ä¸èƒ½ä½¿ç”¨äº†)~~
- åŠŸèƒ½å¤§åŒå°å¼‚, æˆ‘æ ¹æ®è‡ªèº«éœ€æ±‚åŠ äº†åœ¨ç»ˆç«¯ä¸­æ‰«ç , å¤šè¿›ç¨‹æŠ¢ä¸åŒå•†å“
- å…³äº jd å£ç½©é—®é¢˜, å‘ç°å’Œåœ°åŒºæœ‰å¾ˆå¤§å…³ç³», æœ‰çš„åœ°åŒºæ ¹æœ¬ä¸ä¼šæŠ¢åˆ°(æ—¶é—´å¤ªä¹…äº†, ç°åœ¨æ²¡æœ‰äººä¼šåœ¨æ„å£ç½©äº†å§ğŸ˜„)
- å…³äºä¸Šé¢çš„é—®é¢˜, å‡ ä¸ªç±»ä¼¼åº“ issues éƒ½æœ‰è®¨è®º
- https://github.com/zhou-xiaojun/jd_mask/issues/1
- https://github.com/tychxn/jd-assistant/issues/108#issuecomment-592947377
- å‘ç°çœŸçš„åœ°åŒºå·®å¼‚å¾ˆå¤§ï¼Œä¸Šæµ·ä¸€æ¬¡æ²¡æœ‰ï¼Œæœ‹å‹æ±Ÿè‹è¿ç»­ä¿©æ¬¡ ---3-19 æ—¥æœ€æ–°æ›´æ–°
- æ³¨æ„ä½¿ç”¨æœ€å¥½æå‰ä¸ª `1s`, å› ä¸ºæäº¤è®¢å•å‰è¦è¯·æ±‚å…¶ä»–ä¿©ä¸ªæ¥å£, å»¶è¿Ÿ 1s å·®ä¸å¤šæ­£å¥½
- æ¯å¤©æœ€å¥½æå‰åšä¸€æ¬¡æ‰«ç ï¼Œæˆ–è€…å¤šæå‰ä¸€ä¼šå¼€å¯è„šæœ¬

## æˆåŠŸæ¡ˆä¾‹

- è®¢å•<img src="https://user-images.githubusercontent.com/13815865/77068877-56728700-6a22-11ea-8102-925cc25a4b92.png" />

æ›´å¤šæ¡ˆä¾‹: [issues/2](https://github.com/meooxx/jd_by_mask/issues/2)

## Advanced(åºŸå¼ƒ)

_è§£å†³ä¸äº† mac å¾…æœºçŠ¶æ€, ä»£ç ä¸æ‰§è¡Œçš„é—®é¢˜ã€‚ä¼šå»¶è¿Ÿå¾ˆä¹…æ‰æ‰§è¡Œ_

ç†Ÿæ‚‰ `nodejs` å’Œ `golang` ä½¿ç”¨ã€‚æ­£å¸¸ `master` ç‰ˆæœ¬å·²ç»æ»¡è¶³å®é™…ä½¿ç”¨äº†ï¼Œ è¿™éƒ¨åˆ†ä½¿ç”¨è¯´æ˜ä¸ä¼šå¾ˆè¯¦ç»†  
åˆ†æ”¯ `feture-golang` æ–°åŠ äº† `golang` çš„ç‰ˆæœ¬ã€‚ è·Ÿ `master` åˆ†æ”¯ä¸Šçš„åŒºåˆ«:
`master` ä¸Šé¢å…¨éƒ¨æ˜¯ `nodejs`ä»£ç ï¼Œå®é™…ä½¿ç”¨å‘ç°åœ¨å®šæ—¶åŠŸèƒ½å’Œ`cookie` åœ¨ä¼šè¯é—´å‚¨å­˜ä¸æ˜¯å¾ˆé«˜æ•ˆã€‚æ­£å¥½ç•¥æ‡‚ `golang`, å°±ç”¨ `golang` æŠŠæäº¤è®¢å•çš„éƒ¨åˆ†é‡å†™äº†ã€‚
è¿™ä¸ªåˆ†æ”¯ä¸Šé¢çš„æµç¨‹, `nodejs` è´Ÿè´£ç™»å½•çŠ¶æ€ç»´æŠ¤, åŒ…æ‹¬ç™»å½•æµç¨‹ å’Œ åˆå§‹ `cookie` å‚¨å­˜ã€‚ `golang` åªåšå®šæ—¶æäº¤è®¢å•è¿™éƒ¨åˆ†æµç¨‹ã€‚ä¸‹é¢è¿™æ®µæ—¶é—´ï¼Œæµ‹æµ‹å®é™…æ•ˆæœã€‚
å®Œæ•´æµç¨‹ nodejs å¯åŠ¨, ç›‘å¬æœ¬åœ° 8888 ç«¯å£åœ¨åå°ã€‚ golang å¯åŠ¨, func init ä¸­è®¿é—® nodejs http://127.0.0.1:8888/getCookies, è·å¾—ä¸€ç³»åˆ— cookie ç­‰ã€‚ç„¶åç­‰å¾…é¢„çº¦æ—¶é—´, æäº¤è®¢å•

![æµç¨‹å›¾ç‰‡](https://github.com/meooxx/jd_by_mask/blob/master/diagram.svg)

